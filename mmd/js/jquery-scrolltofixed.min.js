!function(t){t.isScrollToFixed=function(e){return!!t(e).data("ScrollToFixed")},t.ScrollToFixed=function(e,i){function g(){s.trigger("preUnfixed.ScrollToFixed"),T(),s.trigger("unfixed.ScrollToFixed"),h=-1,d=s.offset().top,p=s.offset().left,o.options.offsets&&(p+=s.offset().left-s.position().left),-1==c&&(c=p),r=s.css("position"),n=!0,-1!=o.options.bottom&&(s.trigger("preFixed.ScrollToFixed"),$(),s.trigger("fixed.ScrollToFixed"))}function b(){var t=o.options.limit;return t?"function"==typeof t?t.apply(s):t:0}function y(){return"fixed"===r}function x(){return"absolute"===r}function w(){return!(y()||x())}function $(){y()||(u.css({display:s.css("display"),width:s.outerWidth(!0),height:s.outerHeight(!0),"float":s.css("float")}),cssOptions={"z-index":o.options.zIndex,position:"fixed",top:-1==o.options.bottom?F():"",bottom:-1==o.options.bottom?"":o.options.bottom,"margin-left":"0px"},o.options.dontSetWidth||(cssOptions.width=s.width()),s.css(cssOptions),s.addClass(o.options.baseClassName),o.options.className&&s.addClass(o.options.className),r="fixed")}function C(){var t=b(),e=p;o.options.removeOffsets&&(e="",t-=d),cssOptions={position:"absolute",top:t,left:e,"margin-left":"0px",bottom:""},o.options.dontSetWidth||(cssOptions.width=s.width()),s.css(cssOptions),r="absolute"}function T(){w()||(h=-1,u.css("display","none"),s.css({"z-index":f,width:"",position:a,left:"",top:l,"margin-left":""}),s.removeClass("scroll-to-fixed-fixed"),o.options.className&&s.removeClass(o.options.className),r=null)}function S(t){t!=h&&(s.css("left",p-t),h=t)}function F(){var t=o.options.marginTop;return t?"function"==typeof t?t.apply(s):t:0}function k(){if(t.isScrollToFixed(s)){var e=n;n?w()&&(d=s.offset().top,p=s.offset().left):g();var i=t(window).scrollLeft(),r=t(window).scrollTop(),l=b();o.options.minWidth&&t(window).width()<o.options.minWidth?w()&&e||(D(),s.trigger("preUnfixed.ScrollToFixed"),T(),s.trigger("unfixed.ScrollToFixed")):o.options.maxWidth&&t(window).width()>o.options.maxWidth?w()&&e||(D(),s.trigger("preUnfixed.ScrollToFixed"),T(),s.trigger("unfixed.ScrollToFixed")):-1==o.options.bottom?l>0&&r>=l-F()?x()&&e||(D(),s.trigger("preAbsolute.ScrollToFixed"),C(),s.trigger("unfixed.ScrollToFixed")):r>=d-F()?(y()&&e||(D(),s.trigger("preFixed.ScrollToFixed"),$(),h=-1,s.trigger("fixed.ScrollToFixed")),S(i)):w()&&e||(D(),s.trigger("preUnfixed.ScrollToFixed"),T(),s.trigger("unfixed.ScrollToFixed")):l>0?r+t(window).height()-s.outerHeight(!0)>=l-(F()||-E())?y()&&(D(),s.trigger("preUnfixed.ScrollToFixed"),"absolute"===a?C():T(),s.trigger("unfixed.ScrollToFixed")):(y()||(D(),s.trigger("preFixed.ScrollToFixed"),$()),S(i),s.trigger("fixed.ScrollToFixed")):S(i)}}function E(){return o.options.bottom?o.options.bottom:0}function D(){var t=s.css("position");s.trigger("absolute"==t?"postAbsolute.ScrollToFixed":"fixed"==t?"postFixed.ScrollToFixed":"postUnfixed.ScrollToFixed")}var o=this;o.$el=t(e),o.el=e,o.$el.data("ScrollToFixed",o);var r,a,l,f,n=!1,s=o.$el,d=0,p=0,c=-1,h=-1,u=null,A=function(){s.is(":visible")&&(n=!1,k())},U=function(){window.requestAnimationFrame?requestAnimationFrame(k):k()},L=function(t){t=t||window.event,t.preventDefault&&t.preventDefault(),t.returnValue=!1};o.init=function(){o.options=t.extend({},t.ScrollToFixed.defaultOptions,i),f=s.css("z-index"),o.$el.css("z-index",o.options.zIndex),u=t("<div />"),r=s.css("position"),a=s.css("position"),l=s.css("top"),w()&&o.$el.after(u),t(window).bind("resize.ScrollToFixed",A),t(window).bind("scroll.ScrollToFixed",U),"ontouchmove"in window&&t(window).bind("touchmove.ScrollToFixed",k),o.options.preFixed&&s.bind("preFixed.ScrollToFixed",o.options.preFixed),o.options.postFixed&&s.bind("postFixed.ScrollToFixed",o.options.postFixed),o.options.preUnfixed&&s.bind("preUnfixed.ScrollToFixed",o.options.preUnfixed),o.options.postUnfixed&&s.bind("postUnfixed.ScrollToFixed",o.options.postUnfixed),o.options.preAbsolute&&s.bind("preAbsolute.ScrollToFixed",o.options.preAbsolute),o.options.postAbsolute&&s.bind("postAbsolute.ScrollToFixed",o.options.postAbsolute),o.options.fixed&&s.bind("fixed.ScrollToFixed",o.options.fixed),o.options.unfixed&&s.bind("unfixed.ScrollToFixed",o.options.unfixed),o.options.spacerClass&&u.addClass(o.options.spacerClass),s.bind("resize.ScrollToFixed",function(){u.height(s.height())}),s.bind("scroll.ScrollToFixed",function(){s.trigger("preUnfixed.ScrollToFixed"),T(),s.trigger("unfixed.ScrollToFixed"),k()}),s.bind("detach.ScrollToFixed",function(e){L(e),s.trigger("preUnfixed.ScrollToFixed"),T(),s.trigger("unfixed.ScrollToFixed"),t(window).unbind("resize.ScrollToFixed",A),t(window).unbind("scroll.ScrollToFixed",U),s.unbind(".ScrollToFixed"),u.remove(),o.$el.removeData("ScrollToFixed")}),A()},o.init()},t.ScrollToFixed.defaultOptions={marginTop:0,limit:0,bottom:-1,zIndex:1e3,baseClassName:"scroll-to-fixed-fixed"},t.fn.scrollToFixed=function(e){return this.each(function(){new t.ScrollToFixed(this,e)})}}(jQuery);